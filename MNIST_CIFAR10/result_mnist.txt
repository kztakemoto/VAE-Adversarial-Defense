Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
I0626 09:05:11.596405 4793052608 evaluate_VAE_defense.py:49] MNIST Dataset
[INFO] MNIST Dataset
W0626 09:05:11.596709 4793052608 deprecation_wrapper.py:119] From evaluate_VAE_defense.py:51: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

[WARNING] From evaluate_VAE_defense.py:51: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0626 09:05:11.609040 4793052608 deprecation_wrapper.py:119] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0626 09:05:11.611122 4793052608 deprecation_wrapper.py:119] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0626 09:05:11.620699 4793052608 deprecation_wrapper.py:119] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3976: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3976: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

W0626 09:05:11.644410 4793052608 deprecation_wrapper.py:119] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

W0626 09:05:11.649108 4793052608 deprecation.py:506] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0626 09:05:11.689626 4793052608 deprecation_wrapper.py:119] From evaluate_VAE_defense.py:54: The name tf.train.GradientDescentOptimizer is deprecated. Please use tf.compat.v1.train.GradientDescentOptimizer instead.

[WARNING] From evaluate_VAE_defense.py:54: The name tf.train.GradientDescentOptimizer is deprecated. Please use tf.compat.v1.train.GradientDescentOptimizer instead.

W0626 09:05:11.689810 4793052608 deprecation_wrapper.py:119] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0626 09:05:11.695915 4793052608 deprecation_wrapper.py:119] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3295: The name tf.log is deprecated. Please use tf.math.log instead.

2020-06-26 09:05:11.736056: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
W0626 09:05:11.847546 4793052608 deprecation.py:323] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
I0626 09:05:11.952461 4793052608 keras.py:493] Inferred 11 hidden layers on Keras classifier.
[INFO] Inferred 11 hidden layers on Keras classifier.
W0626 09:05:12.030938 4793052608 deprecation_wrapper.py:119] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:2018: The name tf.image.resize_nearest_neighbor is deprecated. Please use tf.compat.v1.image.resize_nearest_neighbor instead.

[WARNING] From /opt/local/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:2018: The name tf.image.resize_nearest_neighbor is deprecated. Please use tf.compat.v1.image.resize_nearest_neighbor instead.

I0626 09:05:12.404206 4793052608 evaluate_VAE_defense.py:65] Craft adversarial images with FGSM
[INFO] Craft adversarial images with FGSM
I0626 09:05:12.404721 4793052608 fast_gradient.py:150] Using model predictions as correct labels for FGM.
[INFO] Using model predictions as correct labels for FGM.
I0626 09:06:45.084101 4793052608 fast_gradient.py:177] Success rate of FGM attack: 45.75%
[INFO] Success rate of FGM attack: 45.75%
I0626 09:06:47.393605 4793052608 evaluate_VAE_defense.py:72] Accuracy on original test images: 99.09%
[INFO] Accuracy on original test images: 99.09%
I0626 09:06:47.476836 4793052608 evaluate_VAE_defense.py:74] Encodeing and decoding clean test images using VAE
[INFO] Encodeing and decoding clean test images using VAE
I0626 09:06:51.161747 4793052608 evaluate_VAE_defense.py:79] Accuracy on test images encoded and decoded using VAE: 98.85%
[INFO] Accuracy on test images encoded and decoded using VAE: 98.85%
I0626 09:06:53.539218 4793052608 evaluate_VAE_defense.py:83] Fooling rate of FGSM attacks on test images: 44.99%
[INFO] Fooling rate of FGSM attacks on test images: 44.99%
I0626 09:06:53.539453 4793052608 evaluate_VAE_defense.py:85] Adversarial defense using VAE
[INFO] Adversarial defense using VAE
I0626 09:06:57.302894 4793052608 evaluate_VAE_defense.py:90] Fooling rate on after adversarial defenses using VAE: 12.89%
[INFO] Fooling rate on after adversarial defenses using VAE: 12.89%
I0626 09:06:57.303341 4793052608 evaluate_VAE_defense.py:110] Plot the orignail image, perturbation, and adversarial image
[INFO] Plot the orignail image, perturbation, and adversarial image
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 16)   160         input_1[0][0]                    
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 14, 14, 16)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 8)    1160        max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 7, 7, 8)      0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 392)          0           max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 256)          100608      flatten_2[0][0]                  
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 256)          100608      flatten_2[0][0]                  
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 256)          0           dense_3[0][0]                    
                                                                 dense_4[0][0]                    
==================================================================================================
Total params: 202,536
Trainable params: 202,536
Non-trainable params: 0
__________________________________________________________________________________________________
None
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 256)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 392)               100744    
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 8)           0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 7, 7, 8)           584       
_________________________________________________________________
up_sampling2d_1 (UpSampling2 (None, 14, 14, 8)         0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 14, 14, 16)        1168      
_________________________________________________________________
up_sampling2d_2 (UpSampling2 (None, 28, 28, 16)        0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 28, 28, 1)         145       
=================================================================
Total params: 102,641
Trainable params: 102,641
Non-trainable params: 0
_________________________________________________________________
None
